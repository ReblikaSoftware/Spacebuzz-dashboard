<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR Sync Dashboard</title>
    <link rel="stylesheet" href="output.css">

    <!-- Add additional scripts and stylesheets as needed -->
</head>
<style>
    .progress-bar {
        transition: background-color 0.5s ease, border-color 0.5s ease, height 0.5s ease;
    }
    
    .bg-green-500 {
        background-color: #10b981; /* Tailwind CSS green-500 */
        border-color: #10b981; /* Ensure the border transitions to the same color */
    }
    </style>
<body class="bg-blue-500">

    <nav class="relative px-4 py-4 flex justify-between items-center bg-white">
        <a class="fixed text-3xl font-bold leading-none" href="#">
             <img src="./img/Spacebuzz-logo_black.png" alt="Spacebuzz logo">
        </a>
        <div class="lg:hidden">
            <button class="navbar-burger flex items-center text-blue-600 p-3">
                <svg class="block h-4 w-4 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Mobile menu</title> 
                    <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path>
                </svg>
            </button>
        </div>
           <!-- <button id="playButton" class="ml-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Play All</button>
            <button id="pauseButton" class="ml-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Pause All</button>
            <button id="restart" class="ml-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Restart</button>
            <button id="stopButton" class="ml-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Stop All</button>-->

            <ol class="relative mx-auto flex w-full max-w-lg ">
                <li class="step flex w-full items-center">
                    <div class="relative flex flex-col items-center">
                        <span class="circle flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-blue-500 text-white">
                            1
                        </span>
                        <div class="text-xs w-24 text-center mt-1">Restart</div>
                    </div>
                    <div id="progressBar1" class="progress-bar flex-auto border-t-2 border-gray-300"></div>
                </li>
                <li class="step flex w-full items-center">
                    <div class="relative flex flex-col items-center">
                        <span class="circle flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-blue-500 text-white">
                            2
                        </span>
                        <div class="text-xs w-24 text-center mt-1">Intro</div>
                    </div>
                    <div id="progressBar2" class="progress-bar flex-auto border-t-2 border-gray-300"></div>
                </li>
                <li class="step">
                    <div class="relative flex flex-col items-center">
                        <span class="circle flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-blue-500 text-white">
                            3
                        </span>
                        <div class="text-xs w-24 text-center mt-1">Start</div>
                    </div>
                </li>
            </ol>
            
            
       
    </nav>
    <div class="flex items-center justify-between text-base text-gray-600 dark:text-gray-400">
       
      
    <div class="navbar-menu relative z-50 hidden">
        <div class="navbar-backdrop fixed inset-0 bg-gray-800 opacity-25"></div>
        <nav class="fixed top-0 left-0 bottom-0 flex flex-col w-5/6 max-w-sm py-6 px-6 bg-white border-r overflow-y-auto">
            <div class="flex items-center mb-8">
                <a class="mr-auto text-3xl font-bold leading-none" href="#">
                    <svg class="h-12" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                        <path fill="#000000" d="M328.85 156.79a26.69 26.69 0 1 0 18.88 7.81a26.6 26.6 0 0 0-18.88-7.81Z"/>
                        <path fill="#000000" d="M477.44 50.06a.29.29 0 0 1 0-.09a20.4 20.4 0 0 0-15.13-15.3c-29.8-7.27-76.68.48-128.63 21.28c-52.36 21-101.42 52-134.58 85.22A320.7 320.7 0 0 0 169.55 175c-22.33-1-42 2.18-58.57 9.41c-57.74 25.41-74.23 90.44-78.62 117.14a25 25 0 0 0 27.19 29h.13l64.32-7.02c.08.82.17 1.57.24 2.26a34.36 34.36 0 0 0 9.9 20.72l31.39 31.41a34.27 34.27 0 0 0 20.71 9.91l2.15.23l-7 64.24v.13A25 25 0 0 0 206 480a25.25 25.25 0 0 0 4.15-.34C237 475.34 302 459.05 327.34 401c7.17-16.46 10.34-36.05 9.45-58.34a314.78 314.78 0 0 0 33.95-29.55c33.43-33.26 64.53-81.92 85.31-133.52c20.69-51.36 28.48-98.59 21.39-129.53ZM370.38 224.94a58.77 58.77 0 1 1 0-83.07a58.3 58.3 0 0 1 0 83.07Z"/>
                        <path fill="#000000" d="M161.93 386.44a16 16 0 0 0-11 2.67c-6.39 4.37-12.81 8.69-19.29 12.9c-13.11 8.52-28.79-6.44-21-20l12.15-21a16 16 0 0 0-15.16-24.91A61.25 61.25 0 0 0 72 353.56c-3.66 3.67-14.79 14.81-20.78 57.26A357.94 357.94 0 0 0 48 447.59A16 16 0 0 0 64 464h.4a359.87 359.87 0 0 0 36.8-3.2c42.47-6 53.61-17.14 57.27-20.8a60.49 60.49 0 0 0 17.39-35.74a16 16 0 0 0-13.93-17.82Z"/>
                    </svg>
                </a>
                <button class="navbar-close">
                    <svg class="h-6 w-6 text-gray-400 cursor-pointer hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div>
                <ul>
                    <li class="mb-1">
                        <a class="block p-4 text-sm font-semibold text-gray-400 hover:bg-blue-50 hover:text-blue-600 rounded" href="index.html">Overview Chairs</a>
                    </li>
                </ul>
            </div>
            <div class="mt-auto">
                <p class="my-4 text-xs text-center text-gray-400">
                    <span>Copyright Â© 2023</span>
                </p>
            </div>
        </nav>
    </div>






    <div class="container mx-auto px-4 py-8">
        <!-- Header with centered content -->
        <header class="flex justify-center items-center mb-2"></header>

        <!-- Main Content -->

           
            <div class="relative py-2 px-4 mx-auto p-5 w-full md:w-4/5 lg:w-3/5 shadow-lg rounded-md bg-white">
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead class="bg-white border-b text-center">
                            <tr>
                                <th scope="col" class="text-sm font-medium text-gray-900 px-6 py-4">Headset Name</th>
                                <th scope="col" class="text-sm font-medium text-gray-900 px-6 py-4">Battery Status</th>
                                <th scope="col" class="text-sm font-medium text-gray-900 px-6 py-4">Connection Status</th>
                                <th scope="col" class="text-sm font-medium text-gray-900 px-6 py-4">Status</th>
                                <th scope="col" class="text-sm font-medium text-gray-900 px-6 py-4">Language</th>
                                <th scope="col" class="text-sm font-medium text-gray-900 px-6 py-4">Control</th>

                            </tr>
                        </thead>
                        <tbody id="deviceTableBody" class="device bg-gray-100 p-2 rounded-lg justify-between items-center mb-2 text-center hover:bg-gray-200">
                            <!-- Device rows will be added here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
   
    </div>


<script>
    // Steppings 
    document.querySelectorAll('.step').forEach((step, index, steps) => {
        step.addEventListener('click', function() {
            const circle = step.querySelector('.circle');
            if (!circle.classList.contains('bg-green-500')) {
                // Update circle to checkmark and green background
                circle.classList.replace('bg-blue-500', 'bg-green-500');
                circle.classList.replace('text-black', 'text-white');
                circle.innerHTML = `<svg aria-hidden="true" class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>`;

                // Check if there is a progress bar to update
                if (index < steps.length - 1) {
                    const progressBar = step.querySelector('.progress-bar');
                    progressBar.classList.add('bg-green-500', 'border-green-500');
                }
            }
        });
    });

    function sendCommandToUrl(url) {
        const username = 'VR'; // Your username here
        const password = 'QbOjBy'; // Your password here
        const encodedCredentials = btoa(`${username}:${password}`);

        const options = {
            method: 'GET',
            headers: {
                'Authorization': `Basic ${encodedCredentials}`
            },
        };

        fetch(url, options)
            .then(response => {
                if (response.ok) {
                    return response.text();
                }
                throw new Error('Network response was not ok.');
            })
            .then(data => console.log(data))
            .catch(error => console.error('There has been a problem with your fetch operation:', error));
    }


    // Function to handle clicks on Step 1
    function handleStep1() {
        const url = 'http://192.168.1.10/dev/sps/io/Idle/Pulse';
        console.log('click');
        sendCommandToUrl(url);
    }

    // Function to handle clicks on Step 2
    function handleStep2() {
        const url = 'http://192.168.1.10/dev/sps/io/StartIntro/Pulse';
        sendCommandToUrl(url);
    }

    // Function to handle clicks on Step 3
    function handleStep3() {
        const url = 'http://192.168.1.10/dev/sps/io/StartIntro/Pulse';
        sendCommandToUrl(url);
        sendCommandToAllDevices('play');

        // Set a timeout for 15 minutes and 13 seconds after Step 3 is pressed
        setTimeout(() => {
            resetSteps();
            sendSpecialStopCommand();
        }, 913000); // 913000 milliseconds = 15 minutes and 13 seconds
    }

    // Function to send the 'stop' command
    function sendSpecialStopCommand() {
        const url = 'http://192.168.1.10/dev/sps/io/StopVR/Pulse';
        sendCommandToUrl(url);
    }

    // Function to reset the steps to their initial state
    function resetSteps() {
        const circles = document.querySelectorAll('.circle');
        circles.forEach((circle, index) => {
            circle.classList.remove('bg-green-500', 'text-white');  // Remove the green background and white text class
            circle.classList.add('bg-blue-500', 'text-white');  // Add the blue background and white text class
            circle.innerHTML = index + 1;  // Reset inner HTML to show step numbers
        });
        document.querySelectorAll('.progress-bar').forEach(bar => {
            bar.classList.remove('bg-green-500');  // Remove green color from the progress bars
        });
    }

    // Adding event listeners to steps
    document.addEventListener('DOMContentLoaded', () => {
        const steps = document.querySelectorAll('.step');
        if (steps.length >= 3) {
            steps[0].addEventListener('click', handleStep1);
            steps[1].addEventListener('click', handleStep2);
            steps[2].addEventListener('click', handleStep3);
        }
    });






    
const ws = new WebSocket('ws://192.168.1.20:5500');
//const ws = new WebSocket('ws://:5500/');
const devices = new Map();
const timeout = 2000;
let deviceCount = 0; // Keep track of device count for naming

ws.onopen = () => {
    console.log('WebSocket connection established.');
};

ws.onerror = (error) => {
    console.error('WebSocket error:', error);
};

// ws.onmessage = function(event) {
//     const data = JSON.parse(event.data);
//     if (data.deviceName && data.uniqueId) {
//         const now = Date.now();
//         const isNewDevice = !devices.has(data.uniqueId);
//         if (isNewDevice) {
//             deviceCount++; // Increment for a new device
//         }
//         devices.set(data.uniqueId, {...data, deviceIndex: deviceCount, isConnected: true, lastUpdate: now});
//         updateDeviceTable(devices.get(data.uniqueId)); // Force UI update on every message
        
//         if (isNewDevice) {
//             const command = JSON.stringify({
//                 uniqueId: data.uniqueId,
//                 command: "nederlands"
//             });
//             ws.send(command);
//             console.log(`Sent nederlands language command to ${data.uniqueId}`);
//         }
//     }
// };

// document.getElementById('playButton').addEventListener('click', () => {
//     fetch('/send-udp-message')
//         .then(response => response.text())
//         .then(data => console.log(data))
//         .catch(error => console.error('Error:', error));
// });


// new code to get the stop massage
ws.onmessage = function(event) {
    const data = JSON.parse(event.data);
        if (data.command === "stopallheadsets") {
            sendCommandToAllDevices('stop')
        } else if (data.uniqueId) {
        const now = Date.now();
        const deviceNameMapping = {
            'b3548d533cfdb86ee5c1d54dbe5a09d0': 'Quest Pro VR0',
            '87996275aa17ab135c5f2ec206d7bd06': 'Quest Pro VR1',
            '0772cef3c81024258e4adecfb8e7edf5': 'Quest Pro VR2',
            '': 'Quest Pro VR3',
            'd34d1a2d1a64a342b83585c8bc1e16c7': 'Quest Pro VR4',
            '49613517e41d8410923cf7420363d9d9': 'Quest Pro VR5',
            '9ae2fb0ba08f67b390f6faaa4c3546c7': 'Quest Pro VR6',
            'dd5044716b0e4a04d1e6c05980f56709': 'Quest Pro VR7',
            'b7e2a14128e198a19be367fbd0d0359f': 'Quest Pro VR8',
            '': 'Quest Pro VR9',
            'c811dcbd4439f155eac7a8427b3e83f3': 'Quest Pro VR10',
            'dfa55dff6bb558a5029c609992b767a9': 'Quest Pro VR11',
            'bbd346417e44755ae4f6f2012a4396fe': 'Quest Pro VR12'

        };

        // Stoel 1 192.168.1.181
        // Stoel 2 192.168.1.182



        // Use the custom name from mapping if available; otherwise, keep the original deviceName.
        const customName = deviceNameMapping[data.uniqueId] || data.deviceName;
        
        // Determine if this is a newly discovered device
        const isNewDevice = !devices.has(data.uniqueId);

        // Merge new data with existing, prioritizing new, and ensure essential fields are updated or added
        const updatedDevice = {
            ...(devices.get(data.uniqueId) || {}),
            ...data,
            deviceName: customName, // Assign the custom or original name
            isConnected: true,
            lastUpdate: now,
            status: data.status || "idle" // Default to "idle" if status is not provided
        };

        // Update the devices map
        devices.set(data.uniqueId, updatedDevice);

        // Update UI components
        if (isNewDevice) {
            // If it's a new device, redraw the entire table might be needed to add the row
            updateDeviceTable();
        } else {
            // For existing devices, just update the necessary parts to reflect new data
            updateDeviceStatus(data.uniqueId, updatedDevice.status);
            updateConnectionStatus(data.uniqueId, true); // Assuming receipt of a message implies connection
        }
    }
};




// Periodically check for disconnected devices
setInterval(function() {
    const currentTime = Date.now();
    devices.forEach((device, uniqueId) => {
        if (currentTime - device.lastUpdate > timeout && device.isConnected) {
            // Mark as disconnected and update the UI
            device.isConnected = false;
            updateDeviceTable(device);
        }
    });
}, 1000);

function getConnectionStatusHTML(isConnected) {
    return isConnected
        ? '<span class="inline-block rounded-full h-3 w-3 bg-green-500"></span> Connected'
        : '<span class="inline-block rounded-full h-3 w-3 bg-red-500"></span> Disconnected';
}


function updateDeviceTable() {
    const tbody = document.getElementById('deviceTableBody');
    let index = 0; // Initialize index for row coloring
    //                <td class="px-6 py-4">${device.deviceName} ${device.deviceIndex}</td>

    devices.forEach((device) => {
        let row = document.getElementById(`device-row-${device.uniqueId}`);
        if (!row) {
            // Row doesn't exist, create new
            row = tbody.insertRow();
            row.id = `device-row-${device.uniqueId}`;
            row.className = index % 2 === 0 ? 'bg-gray-100 hover:bg-gray-200' : 'bg-white hover:bg-gray-200'; // Alternating row color
            // Set the data-unique-id attribute
            row.setAttribute('data-unique-id', device.uniqueId);
            row.innerHTML = `
                <td class="px-6 py-4">${device.deviceName}</td>
                <td class="px-6 py-4" id="battery-status-${device.uniqueId}"></td>
                <td class="px-6 py-4" id="connection-status-${device.uniqueId}"></td>
                <td class="px-6 py-4" id="status-${device.uniqueId}">${getStatusHTML(device.status)}</td>

                <td class="px-6 py-4">
                    <select id="language-select-${device.uniqueId}" onchange="updateVideoPath(this.value, '${device.uniqueId}')">
                        <option value="Nederlands" ${device.language === 'nederlands' ? 'selected' : ''}>Nederlands</option>
                        <option value="English" ${device.language === 'english' ? 'selected' : ''}>English</option>
                        <option value="French" ${device.language === 'french' ? 'selected' : ''}>French</option>
                        <option value="German" ${device.language === 'german' ? 'selected' : ''}>German</option>
                        <option value="Hungarian" ${device.language === 'hungarian' ? 'selected' : ''}>Hungarian</option>
                        <option value="Italian" ${device.language === 'italian' ? 'selected' : ''}>Italian</option>
                    </select>
                </td>
                <td class="px-6 py-4">

                    <button onclick="playVideoOnDevice('${device.uniqueId}')" class="play-button bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-xs mr-1">Play</button>
                    <button onclick="pauseVideoOnDevice('${device.uniqueId}', this)" class="play-button bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-xs mr-1">Pause</button>
                    <button onclick="stopVideoOnDevice('${device.uniqueId}')" class="stop-button bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded text-xs">Stop</button>
                </td>
            `;
        } else {
            // If row exists, make sure it has the correct data-unique-id attribute
            row.setAttribute('data-unique-id', device.uniqueId);
        }
        
        // Update existing row with current data
        document.getElementById(`battery-status-${device.uniqueId}`).textContent = `${device.battery}%`;
        document.getElementById(`connection-status-${device.uniqueId}`).innerHTML = getConnectionStatusHTML(device.isConnected);
        
        index++; // Increment index for the next device
    });
}

function getStatusHTML(status) {
    const statusText = status || "idle"; // Default to "idle" if no status is provided
    const colorClass = status === "playing" ? "bg-green-500" : "bg-gray-500";
    return `<span class="inline-block rounded-full h-3 w-3 ${colorClass}"></span> ${statusText}`;
}

function updateDeviceStatus(uniqueId, status) {
    const statusCell = document.getElementById(`status-${uniqueId}`);
    if (statusCell) {
        statusCell.innerHTML = getStatusHTML(status);
    }
}


function updateVideoPath(language, uniqueId) {
    if (devices.has(uniqueId)) {
        const device = devices.get(uniqueId);
        device.language = language.toLowerCase(); // Convert language to lowercase and update in local storage
        devices.set(uniqueId, device); // Save updated device info
        console.log(`Sending language change command to device ${uniqueId}: ${language.toLowerCase()}`);

        const command = JSON.stringify({
            uniqueId: uniqueId,
            command: language.toLowerCase(),
        });
        ws.send(command);
    }
}

function playVideoOnDevice(uniqueId) {
    if (devices.has(uniqueId)) {
        console.log(`Sending play command to device: ${uniqueId}`);
        const command = JSON.stringify({
            uniqueId: uniqueId,
            command: 'play'
        });
        ws.send(command);
    } else {
        console.error("Device not found:", uniqueId);
    }
}

function pauseVideoOnDevice(uniqueId, buttonElement) {
    if (devices.has(uniqueId)) {
        console.log(`Sending pause command to device: ${uniqueId}`);

        // Toggle the button text based on its current label
        buttonElement.textContent = buttonElement.textContent === 'Pause' ? 'Resume' : 'Pause';

         // Toggle play and pause button visibility
         const playButton = document.querySelector(`button[onclick="playVideoOnDevice('${uniqueId}')"]`);
        if (playButton) {
            playButton.style.display = playButton.style.display === 'none' ? 'inline-block' : 'none'; // Toggle play button visibility
        }

        const command = JSON.stringify({
            uniqueId: uniqueId,
            command: 'pause'
        });
        ws.send(command);
    } else {
        console.error("Device not found:", uniqueId);
    }
}

function restartVideoOnDevice(uniqueId) {
    if (devices.has(uniqueId)) {
        console.log(`Sending skip command to device: ${uniqueId}`);
        const command = JSON.stringify({
            uniqueId: uniqueId,
            command: 'restart'
        });
        ws.send(command);
    } else {
        console.error("Device not found:", uniqueId);
    }
}


function stopVideoOnDevice(uniqueId) {
    if (devices.has(uniqueId)) {
        console.log(`Sending stop command to device: ${uniqueId}`);
        const command = JSON.stringify({
            uniqueId: uniqueId,
            command: 'stop'
        });
        ws.send(command);
    } else {
        console.error("Device not found:", uniqueId);
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // Function to send command to all devices
    function sendCommandToAllDevices(command) {
        devices.forEach((device, uniqueId) => {
            console.log(`Sending '${command}' command to device: ${uniqueId}`);
            const commandToSend = JSON.stringify({
                uniqueId: uniqueId,
                command: command
            });
            ws.send(commandToSend);
        });

        // If the command is 'play', also send the special request to start
        if (command === 'play') {
            sendSpecialPlayCommand();
        }

        // If the command is 'stop', also send the special request to stop
        if (command === 'stop') {
            sendSpecialStopCommand();
        }

        // Example: Posting to an endpoint that handles device commands
    fetch('/api/sendCommand', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ command: command })
    })
    .then(response => response.json())
    .then(data => console.log(data))
    .catch(error => console.error('Error sending command:', error));
        
    }


    // General function to send command to URL with basic auth
    
    
    // Event listeners for global control buttons
    const playButton = document.getElementById('playButton');
    const pauseButton = document.getElementById('pauseButton');
    const stopButton = document.getElementById('stopButton');

    playButton?.addEventListener('click', () => sendCommandToAllDevices('play'));
    pauseButton?.addEventListener('click', () => sendCommandToAllDevices('pause'));
    stopButton?.addEventListener('click', () => sendCommandToAllDevices('stop'));

    // Toggle button text for pause/resume
    let isPaused = false;
    pauseButton?.addEventListener('click', function() {
        pauseButton.textContent = isPaused ? 'Resume All' : 'Pause All';
        playButton.style.display = isPaused ? 'inline-block' : 'none'; // Toggle visibility
        isPaused = !isPaused;
    });
});











    </script>

<script src="app.js"></script>

    <script>
         // Burger menus
    document.addEventListener('DOMContentLoaded', function() {
        // open
        const burger = document.querySelectorAll('.navbar-burger');
        const menu = document.querySelectorAll('.navbar-menu');
    
        if (burger.length && menu.length) {
            for (var i = 0; i < burger.length; i++) {
                burger[i].addEventListener('click', function() {
                    for (var j = 0; j < menu.length; j++) {
                        menu[j].classList.toggle('hidden');
                    }
                });
            }
        }
    
        // close
        const close = document.querySelectorAll('.navbar-close');
        const backdrop = document.querySelectorAll('.navbar-backdrop');
    
        if (close.length) {
            for (var i = 0; i < close.length; i++) {
                close[i].addEventListener('click', function() {
                    for (var j = 0; j < menu.length; j++) {
                        menu[j].classList.toggle('hidden');
                    }
                });
            }
        }
    
        if (backdrop.length) {
            for (var i = 0; i < backdrop.length; i++) {
                backdrop[i].addEventListener('click', function() {
                    for (var j = 0; j < menu.length; j++) {
                        menu[j].classList.toggle('hidden');
                    }
                });
            }
        }
    });

    document.addEventListener('DOMContentLoaded', () => {
    const dropdownToggles = document.querySelectorAll('.dropdown-toggle');

        dropdownToggles.forEach(toggle => {
            toggle.addEventListener('click', (event) => {
                // Close any open dropdowns
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    if (menu !== event.target.nextElementSibling) {
                        menu.classList.add('hidden');
                    }
                });

                // Toggle the clicked dropdown
                const dropdownMenu = event.target.nextElementSibling || event.target.parentElement.nextElementSibling;
                dropdownMenu.classList.toggle('hidden');
            });
        });

        // Close dropdowns when clicking outside
        window.addEventListener('click', (event) => {
            if (!event.target.matches('.dropdown-toggle')) {
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    menu.classList.add('hidden');
                });
            }
        }, true);
    });
    </script>
    
</body>
</html>